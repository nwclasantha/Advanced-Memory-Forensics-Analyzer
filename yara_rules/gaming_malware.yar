/*
    Gaming Malware Detection
    Game cheats, account stealers, and gaming-related threats
*/

rule Gaming_Steam_Stealer {
    meta:
        description = "Steam account stealer"
        severity = "critical"
    strings:
        $steam = "Steam" ascii nocase
        $valve = "Valve" ascii nocase
        $ssfn = ".ssfn" ascii
        $config = "config.vdf" ascii
        $loginusers = "loginusers.vdf" ascii
        $sentry = "sentry" ascii nocase
        $steal = "steal" ascii nocase
        $grab = "grab" ascii nocase
    condition:
        ($steam or $valve) and (any of ($ssfn, $config, $loginusers, $sentry)) and (any of ($steal, $grab))
}

rule Gaming_Discord_Token_Stealer {
    meta:
        description = "Discord token stealer"
        severity = "critical"
    strings:
        $discord = "discord" ascii nocase
        $token = "token" ascii nocase
        $leveldb = "leveldb" ascii
        $storage = "Local Storage" ascii
        $steal = "steal" ascii nocase
        $grab = "grab" ascii nocase
        $webhook = "webhook" ascii nocase
    condition:
        $discord and $token and (any of ($leveldb, $storage) or any of ($steal, $grab, $webhook))
}

rule Gaming_Minecraft_Stealer {
    meta:
        description = "Minecraft account stealer"
        severity = "high"
    strings:
        $minecraft = "minecraft" ascii nocase
        $mojang = "Mojang" ascii nocase
        $launcher = "launcher" ascii nocase
        $profiles = "launcher_profiles" ascii
        $token = "accessToken" ascii
        $steal = "steal" ascii nocase
    condition:
        (any of ($minecraft, $mojang)) and ($launcher or $profiles or $token) and $steal
}

rule Gaming_Fortnite_Stealer {
    meta:
        description = "Fortnite/Epic account stealer"
        severity = "high"
    strings:
        $fortnite = "Fortnite" ascii nocase
        $epic = "Epic" ascii nocase
        $launcher = "EpicGamesLauncher" ascii
        $cookie = "cookie" ascii nocase
        $session = "session" ascii nocase
        $token = "token" ascii nocase
        $steal = "steal" ascii nocase
    condition:
        (any of ($fortnite, $epic)) and ($launcher or any of ($cookie, $session, $token)) and $steal
}

rule Gaming_Origin_Stealer {
    meta:
        description = "Origin/EA account stealer"
        severity = "high"
    strings:
        $origin = "Origin" ascii nocase
        $ea = "Electronic Arts" ascii nocase
        $local = "local.xml" ascii
        $cookie = "cookie" ascii nocase
        $token = "token" ascii nocase
        $steal = "steal" ascii nocase
    condition:
        (any of ($origin, $ea)) and ($local or any of ($cookie, $token)) and $steal
}

rule Gaming_Battle_Net_Stealer {
    meta:
        description = "Battle.net account stealer"
        severity = "high"
    strings:
        $battlenet = "Battle.net" ascii nocase
        $blizzard = "Blizzard" ascii nocase
        $agent = "Agent.db" ascii
        $cookie = "cookie" ascii nocase
        $token = "token" ascii nocase
        $steal = "steal" ascii nocase
    condition:
        (any of ($battlenet, $blizzard)) and ($agent or any of ($cookie, $token)) and $steal
}

rule Gaming_Roblox_Stealer {
    meta:
        description = "Roblox account stealer"
        severity = "high"
    strings:
        $roblox = "Roblox" ascii nocase
        $robux = "Robux" ascii nocase
        $cookie = ".ROBLOSECURITY" ascii
        $session = "session" ascii nocase
        $steal = "steal" ascii nocase
        $grab = "grab" ascii nocase
    condition:
        (any of ($roblox, $robux)) and ($cookie or $session) and (any of ($steal, $grab))
}

rule Gaming_League_Stealer {
    meta:
        description = "League of Legends account stealer"
        severity = "high"
    strings:
        $lol = "League of Legends" ascii nocase
        $riot = "Riot" ascii nocase
        $league = "League" ascii nocase
        $account = "account" ascii nocase
        $cookie = "cookie" ascii nocase
        $steal = "steal" ascii nocase
    condition:
        (any of ($lol, $riot, $league)) and (any of ($account, $cookie)) and $steal
}

rule Gaming_Aimbot_Generic {
    meta:
        description = "Generic aimbot cheat"
        severity = "medium"
    strings:
        $aimbot = "aimbot" ascii nocase
        $aim = "aim" ascii nocase
        $lock = "lock" ascii nocase
        $target = "target" ascii nocase
        $fov = "fov" ascii nocase
        $smooth = "smooth" ascii nocase
        $bone = "bone" ascii nocase
        $head = "head" ascii nocase
    condition:
        $aimbot or (($aim and $lock) and any of ($target, $fov, $smooth, $bone, $head))
}

rule Gaming_Wallhack_Generic {
    meta:
        description = "Generic wallhack cheat"
        severity = "medium"
    strings:
        $wallhack = "wallhack" ascii nocase
        $wall = "wall" ascii nocase
        $esp = "ESP" ascii
        $chams = "chams" ascii nocase
        $glow = "glow" ascii nocase
        $see = "see through" ascii nocase
        $xray = "xray" ascii nocase
    condition:
        $wallhack or ($wall and any of ($esp, $chams, $glow)) or any of ($xray, $see)
}

rule Gaming_Speedhack_Generic {
    meta:
        description = "Generic speedhack cheat"
        severity = "medium"
    strings:
        $speedhack = "speedhack" ascii nocase
        $speed = "speed" ascii nocase
        $hack = "hack" ascii nocase
        $timer = "timer" ascii nocase
        $multiply = "multiply" ascii nocase
        $fast = "fast" ascii nocase
        $move = "move" ascii nocase
    condition:
        $speedhack or (($speed and $hack) and any of ($timer, $multiply, $fast, $move))
}

rule Gaming_Memory_Hack {
    meta:
        description = "Game memory manipulation"
        severity = "high"
    strings:
        $read = "ReadProcessMemory" ascii
        $write = "WriteProcessMemory" ascii
        $open = "OpenProcess" ascii
        $game = "game" ascii nocase
        $hack = "hack" ascii nocase
        $cheat = "cheat" ascii nocase
        $inject = "inject" ascii nocase
    condition:
        uint16(0) == 0x5A4D and ($read or $write) and $open and (any of ($game, $hack, $cheat, $inject))
}

rule Gaming_Dll_Injector {
    meta:
        description = "Game DLL injector"
        severity = "high"
    strings:
        $inject = "inject" ascii nocase
        $dll = ".dll" ascii nocase
        $loadlibrary = "LoadLibrary" ascii
        $virtualalloc = "VirtualAllocEx" ascii
        $write = "WriteProcessMemory" ascii
        $remote = "CreateRemoteThread" ascii
        // UNUSED: $game = "game" ascii nocase
    condition:
        uint16(0) == 0x5A4D and ($inject and $dll) and (2 of ($loadlibrary, $virtualalloc, $write, $remote))
}

rule Gaming_Triggerbot {
    meta:
        description = "Triggerbot cheat"
        severity = "medium"
    strings:
        $triggerbot = "triggerbot" ascii nocase
        $trigger = "trigger" ascii nocase
        $shoot = "shoot" ascii nocase
        $auto = "auto" ascii nocase
        $fire = "fire" ascii nocase
        $crosshair = "crosshair" ascii nocase
        $target = "target" ascii nocase
    condition:
        $triggerbot or (($trigger and any of ($shoot, $fire)) and any of ($auto, $crosshair, $target))
}

rule Gaming_NoRecoil {
    meta:
        description = "No recoil cheat"
        severity = "medium"
    strings:
        $norecoil = "norecoil" ascii nocase
        $recoil = "recoil" ascii nocase
        $no = "no" ascii nocase
        $spread = "spread" ascii nocase
        $control = "control" ascii nocase
        $remove = "remove" ascii nocase
    condition:
        $norecoil or (($no and $recoil) and any of ($spread, $control, $remove))
}

rule Gaming_Skin_Changer {
    meta:
        description = "Skin changer cheat"
        severity = "low"
    strings:
        $skin = "skin" ascii nocase
        $changer = "changer" ascii nocase
        $inventory = "inventory" ascii nocase
        $knife = "knife" ascii nocase
        $glove = "glove" ascii nocase
        $csgo = "CSGO" ascii nocase
    condition:
        ($skin and $changer) and (any of ($inventory, $knife, $glove, $csgo))
}

rule Gaming_Hwid_Spoofer {
    meta:
        description = "HWID spoofer"
        severity = "high"
    strings:
        $hwid = "HWID" ascii nocase
        $spoof = "spoof" ascii nocase
        $serial = "serial" ascii nocase
        $disk = "disk" ascii nocase
        $mac = "MAC" ascii
        $ban = "ban" ascii nocase
        $bypass = "bypass" ascii nocase
    condition:
        ($hwid and $spoof) or (($serial or $disk or $mac) and any of ($spoof, $ban, $bypass))
}

rule Gaming_AntiCheat_Bypass {
    meta:
        description = "Anti-cheat bypass"
        severity = "critical"
    strings:
        $anticheat = "anti-cheat" ascii nocase
        $eac = "EasyAntiCheat" ascii nocase
        $vac = "VAC" ascii
        $battleye = "BattlEye" ascii nocase
        $bypass = "bypass" ascii nocase
        $disable = "disable" ascii nocase
        $patch = "patch" ascii nocase
    condition:
        (any of ($anticheat, $eac, $vac, $battleye)) and (any of ($bypass, $disable, $patch))
}

rule Gaming_Crypto_Grabber {
    meta:
        description = "Gaming crypto wallet grabber"
        severity = "critical"
    strings:
        $crypto = "crypto" ascii nocase
        $wallet = "wallet" ascii nocase
        $nft = "NFT" ascii
        $metamask = "MetaMask" ascii nocase
        $steam = "Steam" ascii nocase
        $discord = "Discord" ascii nocase
        $grab = "grab" ascii nocase
        $steal = "steal" ascii nocase
    condition:
        (any of ($crypto, $wallet, $nft, $metamask)) and (any of ($steam, $discord)) and (any of ($grab, $steal))
}

